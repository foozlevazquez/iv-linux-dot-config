(function(){var g,l=this,m=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},n=function(a){return"string"==typeof a},s=function(a){return a[r]||(a[r]=++aa)},r="closure_uid_"+(1E9*Math.random()>>>0),aa=0,ba=function(a,b,c){return a.call.apply(a.bind,arguments)},ca=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,
arguments)}},t=function(a,b,c){t=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ba:ca;return t.apply(null,arguments)},da=Date.now||function(){return+new Date},u=function(a,b){function c(){}c.prototype=b.prototype;a.i=b.prototype;a.prototype=new c};Function.prototype.bind=Function.prototype.bind||function(a,b){if(1<arguments.length){var c=Array.prototype.slice.call(arguments,1);c.unshift(this,a);return t.apply(null,c)}return t(this,a)};var v=Array.prototype,ea=v.indexOf?function(a,b,c){return v.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(n(a))return n(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var w=function(a){try{this.o=window[a]}catch(b){this.o=null}},fa=new w("sessionStorage");w.prototype.set=function(a,b){if(this.o){var c={};c.data=b;c.timestamp=da();c=JSON.stringify(c);try{this.o.setItem(a,c)}catch(d){}}};var x,y,z,A,B=function(){return l.navigator?l.navigator.userAgent:null};A=z=y=x=!1;var C;if(C=B()){var ga=l.navigator;x=0==C.lastIndexOf("Opera",0);y=!x&&(-1!=C.indexOf("MSIE")||-1!=C.indexOf("Trident"));z=!x&&-1!=C.indexOf("WebKit");A=!x&&!z&&!y&&"Gecko"==ga.product}var D=x,E=y,F=A,G=z,H=l.navigator,ha=-1!=(H&&H.platform||"").indexOf("Mac"),I=function(){var a=l.document;return a?a.documentMode:void 0},J;
t:{var K="",L;if(D&&l.opera)var M=l.opera.version,K="function"==typeof M?M():M;else if(F?L=/rv\:([^\);]+)(\)|;)/:E?L=/\b(?:MSIE|rv)\s+([^\);]+)(\)|;)/:G&&(L=/WebKit\/(\S+)/),L)var N=L.exec(B()),K=N?N[1]:"";if(E){var ia=I();if(ia>parseFloat(K)){J=String(ia);break t}}J=K}
var ja=J,ka={},O=function(a){var b;if(!(b=ka[a])){b=0;for(var c=String(ja).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",k=d[f]||"",Aa=RegExp("(\\d*)(\\D*)","g"),Ba=RegExp("(\\d*)(\\D*)","g");do{var p=Aa.exec(h)||["","",""],q=Ba.exec(k)||["","",""];if(0==p[0].length&&0==q[0].length)break;b=((0==p[1].length?0:parseInt(p[1],10))<(0==q[1].length?0:parseInt(q[1],10))?-1:(0==p[1].length?
0:parseInt(p[1],10))>(0==q[1].length?0:parseInt(q[1],10))?1:0)||((0==p[2].length)<(0==q[2].length)?-1:(0==p[2].length)>(0==q[2].length)?1:0)||(p[2]<q[2]?-1:p[2]>q[2]?1:0)}while(0==b)}b=ka[a]=0<=b}return b},la=l.document,ma=la&&E?I()||("CSS1Compat"==la.compatMode?parseInt(ja,10):5):void 0;!F&&!E||E&&E&&9<=ma||F&&O("1.9.1");E&&O("9");var na=function(a){var b=document;return n(a)?b.getElementById(a):a};var P=function(){};P.prototype.p=!1;P.prototype.n=function(){this.p||(this.p=!0,this.c())};P.prototype.c=function(){if(this.q)for(;this.q.length;)this.q.shift()()};var Q=function(a){Q[" "](a);return a};Q[" "]=function(){};var oa=!E||E&&9<=ma,pa=E&&!O("9");!G||O("528");F&&O("1.9b")||E&&O("8")||D&&O("9.5")||G&&O("528");F&&!O("8")||E&&O("9");var R=function(a,b){this.type=a;this.currentTarget=this.target=b};g=R.prototype;g.c=function(){};g.n=function(){};g.l=!1;g.defaultPrevented=!1;g.u=!0;g.preventDefault=function(){this.defaultPrevented=!0;this.u=!1};var S=function(a,b){if(a){var c=this.type=a.type;R.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(F){var e;t:{try{Q(d.nodeName);e=!0;break t}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=G||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=G||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:
a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.s=ha?a.metaKey:a.ctrlKey;this.state=a.state;this.j=a;a.defaultPrevented&&this.preventDefault();delete this.l}};u(S,R);g=S.prototype;g.target=null;g.relatedTarget=null;g.offsetX=0;g.offsetY=0;g.clientX=0;g.clientY=0;g.screenX=0;g.screenY=0;
g.button=0;g.keyCode=0;g.charCode=0;g.ctrlKey=!1;g.altKey=!1;g.shiftKey=!1;g.metaKey=!1;g.s=!1;g.j=null;g.preventDefault=function(){S.i.preventDefault.call(this);var a=this.j;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,pa)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};g.c=function(){};var qa="closure_listenable_"+(1E6*Math.random()|0),ra=0;var sa=function(a,b,c,d,e){this.d=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.f=e;this.key=++ra;this.removed=this.g=!1},T=function(a){a.removed=!0;a.d=null;a.proxy=null;a.src=null;a.f=null};var U=function(a){this.src=a;this.a={};this.e=0};U.prototype.add=function(a,b,c,d,e){var f=this.a[a];f||(f=this.a[a]=[],this.e++);var h;t:{for(h=0;h<f.length;++h){var k=f[h];if(!k.removed&&k.d==b&&k.capture==!!d&&k.f==e)break t}h=-1}-1<h?(a=f[h],c||(a.g=!1)):(a=new sa(b,this.src,a,!!d,e),a.g=c,f.push(a));return a};U.prototype.removeAll=function(a){var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,T(d[e]);delete this.a[c];this.e--}return b};var ta={},V={},W={},X=function(a,b,c,d,e){if("array"==m(b)){for(var f=0;f<b.length;f++)X(a,b[f],c,d,e);return null}c=ua(c);if(a&&a[qa])a=va(a,b,c,d,e);else{f=c;if(!b)throw Error("Invalid event type");c=!!d;var h=s(a),k=V[h];k||(V[h]=k=new U(a));d=k.add(b,f,!1,d,e);d.proxy||(e=wa(),d.proxy=e,e.src=a,e.d=d,a.addEventListener?a.addEventListener(b,e,c):a.attachEvent(b in W?W[b]:W[b]="on"+b,e),ta[d.key]=d);a=d}return a},wa=function(){var a=xa,b=oa?function(c){return a.call(b.src,b.d,c)}:function(c){c=
a.call(b.src,b.d,c);if(!c)return c};return b},ya=function(a){if("number"==typeof a||!a||a.removed)return!1;var b=a.src;if(b&&b[qa])return b.v(a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent(c in W?W[c]:W[c]="on"+c,d);if(c=b[r]?V[s(b)]||null:null){var d=a.type,e;if(e=d in c.a){e=c.a[d];var f=ea(e,a),h;(h=0<=f)&&v.splice.call(e,f,1);e=h}e&&(T(a),0==c.a[d].length&&(delete c.a[d],c.e--));0==c.e&&(c.src=null,delete V[s(b)])}else T(a);delete ta[a.key];
return!0},Ca=function(a,b,c,d){var e=1;if(a=a[r]?V[s(a)]||null:null)if(b=a.a[b]){a=b.length;if(0<a){for(var f=Array(a),h=0;h<a;h++)f[h]=b[h];b=f}else b=[];for(a=0;a<b.length;a++)(f=b[a])&&(f.capture==c&&!f.removed)&&(e&=!1!==za(f,d))}return Boolean(e)},za=function(a,b){var c=a.d,d=a.f||a.src;a.g&&ya(a);return c.call(d,b)},xa=function(a,b){if(a.removed)return!0;if(!oa){var c;if(!(c=b))t:{c=["window","event"];for(var d=l,e;e=c.shift();)if(null!=d[e])d=d[e];else{c=null;break t}c=d}e=c;c=new S(e,this);
d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){t:{var f=!1;if(0==e.keyCode)try{e.keyCode=-1;break t}catch(h){f=!0}if(f||void 0==e.returnValue)e.returnValue=!0}e=[];for(f=c.currentTarget;f;f=f.parentNode)e.push(f);for(var f=a.type,k=e.length-1;!c.l&&0<=k;k--)c.currentTarget=e[k],d&=Ca(e[k],f,!0,c);for(k=0;!c.l&&k<e.length;k++)c.currentTarget=e[k],d&=Ca(e[k],f,!1,c)}return d}return za(a,new S(b,this))},Da="__closure_events_fn_"+(1E9*Math.random()>>>0),ua=function(a){return"function"==m(a)?a:a[Da]||
(a[Da]=function(b){return a.handleEvent(b)})};var Y=function(a){this.t=a;this.m={}};u(Y,P);var Ea=[],va=function(a,b,c,d,e){"array"!=m(c)&&(Ea[0]=c,c=Ea);for(var f=0;f<c.length;f++){var h=X(b,c[f],d||a,e||!1,a.t||a);if(!h)break;a.m[h.key]=h}return a};Y.prototype.removeAll=function(){var a=this.m,b;for(b in a)ya.call(void 0,a[b]);this.m={}};Y.prototype.c=function(){Y.i.c.call(this);this.removeAll()};Y.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};var Z=function(a){Y.call(this);this.k=a;this.h=t(this.r,this);Fa(this,"centralJidListener");va(this,this.k,"callPhone centralJidSet getCentralJid onMoleClosed hav hasVoice hw mmm *mfo newVideoChat newVoiceChat oc ocbek ocfp onMoleOpened showChat showChatBG startReplyByChat startVideo startVoice".split(" "),this);chrome.runtime.sendMessage({msg:"onContentPageLoaded"});fa.set("hasExtension",!0)},$;u(Z,Y);Z.prototype.c=function(){Z.i.c.call(this);Ga(this);delete this.h;delete this.k};
var Ia=function(){var a=na("roster_comm_link")||na("mainElement");a&&($=new Z(a),X(window,"unload",Ha))},Ha=function(){var a=$;a&&"function"==typeof a.n&&a.n();$=null};
Z.prototype.handleEvent=function(a){var b=a.j;a=b.type;switch(a){case "newVideoChat":a="startVideo";break;case "newVoiceChat":a="startVoice"}switch(a){case "callPhone":case "getCentralJid":case "newVideoChat":case "newVoiceChat":case "oc":case "ocbek":case "ocfp":case "showChat":case "showChatBG":case "startReplyByChat":case "startVideo":case "startVoice":this.b&&"centralJidListener"==this.b.name&&(b=n(b.data)?{jid:b.data}:b.data,b.msg=a,chrome.runtime.sendMessage(b));break;case "mmm":b=n(b.data.jid)?
JSON.parse(b.data.jid):[];chrome.runtime.sendMessage({msg:a,params:b});break;case "onMoleOpened":case "onMoleClosed":case "*mfo":chrome.runtime.sendMessage({msg:a,jid:b.data});break;case "hasVoice":chrome.runtime.sendMessage({msg:a,voice:!!b.data});break;case "hw":chrome.runtime.sendMessage({msg:a,wabel:!!b.data});break;case "hav":chrome.runtime.sendMessage({msg:a,av:!!b.data});break;case "centralJidSet":Fa(this,"centralJidBroadcaster"),this.b.postMessage({jid:b.data})}};
Z.prototype.r=function(a){var b=a.eventType;delete a.eventType;a=void 0!==a.ttl||void 0!==a.rbcData?a:a.jid;var c=document.createEvent("MessageEvent");c.initMessageEvent(b,!0,!0,a);this.k.dispatchEvent(c)};var Fa=function(a,b){Ga(a);a.b=chrome.runtime.connect({name:b});a.b.onMessage.addListener(a.h)},Ga=function(a){a.b&&(a.b.onMessage.removeListener(a.h),a.b.disconnect(),delete a.b)};"complete"===document.readyState||"interactive"===document.readyState?Ia():X(window,"DOMContentLoaded",Ia);})()
